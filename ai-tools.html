<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Study Tools - The Nursing Collective</title>
    <meta name="description" content="Upload your lecture notes and get AI-generated review sheets, NCLEX practice questions, and more.">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/images/favicon-96x96.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">

    <!-- Theme Color -->
    <meta name="theme-color" content="#2E86AB">

    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

    <!-- Bundled CSS -->
    <link rel="stylesheet" href="css/bundle.min.css">
    <link rel="stylesheet" href="css/pages.css?v=5.3.navbar">
    <link rel="stylesheet" href="css/global-overrides.css?v=6.2.guides">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Lockscreen (must run before body renders — instant no-op for unlocked users) -->
    <script src="lockscreen.js"></script>
    <!-- Sentry Error Tracking (defer: ordered but non-render-blocking) -->
    <script defer src="https://browser.sentry-cdn.com/8.40.0/bundle.min.js" crossorigin="anonymous"></script>
    <script defer src="sentry-init.js"></script>

    <style>
        /* ═══ AI Study Tools Styles ═══ */

        /* Section container */
        .ai-tools-section{padding:0}
        .ai-tools-section .section-header-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
        .ai-tools-section .section-title{font-family:'Outfit',sans-serif;font-size:1.15rem;font-weight:700;color:#0f172a;display:flex;align-items:center;gap:8px;margin:0}
        .ai-tools-section .section-title i{color:#7c3aed;font-size:1rem}

        /* Upload dropzone */
        .ai-upload-dropzone{border:2px dashed #cbd5e1;border-radius:12px;padding:32px 24px;text-align:center;cursor:pointer;transition:all .2s ease;background:#fafbfc}
        .ai-upload-dropzone:hover,.ai-upload-dropzone.drag-over{border-color:#7c3aed;background:rgba(124,58,237,.04)}
        .ai-upload-dropzone.drag-over{box-shadow:0 0 0 3px rgba(124,58,237,.12)}
        .ai-upload-icon{font-size:2rem;color:#94a3b8;margin-bottom:8px;transition:color .2s}
        .ai-upload-dropzone:hover .ai-upload-icon,.ai-upload-dropzone.drag-over .ai-upload-icon{color:#7c3aed}
        .ai-upload-text{font-family:'Source Sans 3',sans-serif;font-size:.95rem;color:#475569;margin-bottom:4px}
        .ai-upload-text strong{display:block;font-size:1rem;color:#1e293b;margin-bottom:2px}
        .ai-upload-text span{font-size:.85rem;color:#94a3b8}
        .ai-upload-formats{font-size:.75rem;color:#94a3b8;margin-top:8px}

        /* Upload progress */
        .ai-upload-progress{margin-top:12px;padding:12px 16px;background:#f8fafc;border-radius:10px;border:1px solid rgba(0,0,0,.06)}
        .ai-progress-info{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:.82rem;color:#475569}
        .ai-progress-filename{font-weight:600;max-width:70%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
        .ai-progress-bar{height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden}
        .ai-progress-fill{height:100%;background:linear-gradient(90deg,#7c3aed,#a78bfa);border-radius:3px;transition:width .3s ease}

        /* Documents list */
        .ai-documents{margin-top:20px}
        .ai-documents-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
        .ai-documents-header h3{font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:600;color:#334155;margin:0}
        .ai-refresh-btn{background:none;border:none;color:#94a3b8;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all .15s}
        .ai-refresh-btn:hover{color:#7c3aed;background:rgba(124,58,237,.06)}

        .ai-documents-list{display:flex;flex-direction:column;gap:8px}
        .ai-empty-state{text-align:center;padding:24px;color:#94a3b8}
        .ai-empty-state i{font-size:2rem;margin-bottom:8px;display:block}
        .ai-empty-state p{font-size:.88rem;margin:0}

        /* Document card */
        .ai-doc-card{display:flex;flex-direction:column;gap:0;padding:0;background:#f8fafc;border-radius:12px;border:1px solid rgba(0,0,0,.05);transition:border-color .15s;overflow:hidden}
        .ai-doc-card:hover{border-color:rgba(124,58,237,.2)}
        .ai-doc-header{display:flex;align-items:center;gap:12px;padding:14px 16px}
        .ai-doc-icon{font-size:1.3rem;color:#7c3aed;flex-shrink:0;width:32px;text-align:center}
        .ai-doc-info{flex:1;min-width:0}
        .ai-doc-name{font-family:'Source Sans 3',sans-serif;font-size:.88rem;font-weight:600;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .ai-doc-meta{font-size:.72rem;color:#94a3b8;margin-top:2px}
        .ai-doc-status{flex-shrink:0;display:flex;align-items:center;gap:6px;font-size:.75rem;font-weight:600;padding:4px 10px;border-radius:8px}
        .ai-doc-status.status-ready{background:rgba(16,185,129,.1);color:#059669}
        .ai-doc-status.status-processing{background:rgba(245,158,11,.1);color:#d97706}
        .ai-doc-status.status-failed{background:rgba(239,68,68,.1);color:#dc2626}
        .ai-doc-status.status-uploaded{background:rgba(59,130,246,.1);color:#3b82f6}
        .ai-doc-btn{padding:6px 14px;font-size:.78rem;font-weight:600;border-radius:8px;border:none;cursor:pointer;transition:all .15s;font-family:'Source Sans 3',sans-serif}
        .ai-doc-btn.btn-delete{background:none;color:#94a3b8;padding:6px 8px;flex-shrink:0}
        .ai-doc-btn.btn-delete:hover{color:#ef4444;background:rgba(239,68,68,.06)}

        /* Action button grid */
        .ai-action-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:4px;padding:4px 12px 12px}
        .ai-action-btn{display:flex;flex-direction:column;align-items:center;gap:3px;padding:10px 4px 8px;border:1px solid rgba(0,0,0,.05);border-radius:8px;background:var(--action-bg);color:var(--action-color);font-family:'Source Sans 3',sans-serif;font-size:.7rem;font-weight:600;cursor:pointer;transition:all .15s;position:relative;line-height:1.2;text-align:center}
        .ai-action-btn i{font-size:.9rem}
        .ai-action-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 3px 10px rgba(0,0,0,.08);border-color:var(--action-color)}
        .ai-action-btn:disabled,.ai-action-btn.ai-action-disabled{opacity:.3;cursor:not-allowed;transform:none!important;box-shadow:none!important}
        .ai-action-cached{position:absolute;top:4px;right:4px;width:7px;height:7px;border-radius:50%;background:#10b981;box-shadow:0 0 0 2px #f8fafc}
        .ai-action-btn.generating{pointer-events:none;opacity:.65}
        .ai-action-btn.generating i{display:none}
        .ai-action-btn.generating::before{content:'';display:inline-block;width:14px;height:14px;border:2px solid rgba(0,0,0,.12);border-top-color:var(--action-color);border-radius:50%;animation:ai-spin .8s linear infinite}

        /* Processing spinner */
        .ai-spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(217,119,6,.3);border-top-color:#d97706;border-radius:50%;animation:ai-spin .8s linear infinite}
        @keyframes ai-spin{to{transform:rotate(360deg)}}

        /* Summary slide-over panel */
        .ai-summary-backdrop{position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,.4);backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);opacity:0;transition:opacity .3s ease}
        .ai-summary-backdrop.visible{opacity:1}
        .ai-summary-panel{position:fixed;top:0;right:0;width:min(720px,85vw);height:100vh;height:100dvh;z-index:10000;background:#fff;display:flex;flex-direction:column;box-shadow:-4px 0 24px rgba(0,0,0,.12);transform:translateX(100%);transition:transform .35s cubic-bezier(.4,0,.2,1)}
        .ai-summary-panel.open{transform:translateX(0)}

        /* Toolbar */
        .ai-summary-toolbar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;flex-shrink:0;box-shadow:0 2px 8px rgba(0,0,0,.1)}
        .ai-summary-toolbar-left,.ai-summary-toolbar-right{display:flex;align-items:center;gap:8px}
        .ai-summary-doc-name{font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:260px}
        .ai-toolbar-btn{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:8px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.12);color:#fff;font-family:'Source Sans 3',sans-serif;font-size:.82rem;font-weight:600;cursor:pointer;transition:all .15s}
        .ai-toolbar-btn:hover{background:rgba(255,255,255,.22);transform:translateY(-1px)}
        .ai-toolbar-btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
        .ai-toolbar-btn--regenerate{border-color:rgba(245,158,11,.4);background:rgba(245,158,11,.15)}
        .ai-toolbar-btn--regenerate:hover{background:rgba(245,158,11,.3)}
        .ai-toolbar-btn--quiz{border-color:rgba(59,130,246,.4);background:rgba(59,130,246,.15)}
        .ai-toolbar-btn--quiz:hover{background:rgba(59,130,246,.3)}

        /* Body / Content */
        .ai-summary-body{flex:1;overflow-y:auto;padding:28px 32px 20px;scroll-behavior:smooth}
        .ai-summary-content{font-family:'Source Sans 3',sans-serif;font-size:.93rem;line-height:1.75;color:#334155;max-width:100%}
        .ai-summary-content h1{font-family:'Outfit',sans-serif;font-size:1.3rem;font-weight:700;color:#0f172a;margin:28px 0 16px;padding-bottom:12px;border-bottom:2px solid rgba(124,58,237,.15)}
        .ai-summary-content h2{font-family:'Outfit',sans-serif;font-size:1.05rem;font-weight:700;color:#1e293b;padding:12px 16px;margin:28px 0 14px;background:linear-gradient(135deg,#f5f3ff,#ede9fe);border-left:4px solid #7c3aed;border-bottom:none;border-radius:0 8px 8px 0;display:flex;align-items:center;gap:8px}
        .ai-summary-content h2 i{font-size:.9rem;color:#7c3aed;flex-shrink:0}
        .ai-summary-content h3{font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:600;color:#475569;margin:20px 0 8px;padding-left:12px;border-left:3px solid rgba(124,58,237,.3)}
        .ai-summary-content ul{list-style:none;padding-left:0;margin:10px 0}
        .ai-summary-content ol{padding-left:24px;margin:10px 0}
        .ai-summary-content li{margin-bottom:6px;padding-left:24px;position:relative;line-height:1.6}
        .ai-summary-content ul > li::before{content:'';position:absolute;left:6px;top:10px;width:6px;height:6px;border-radius:50%;background:#7c3aed}
        .ai-summary-content li.ai-sub{margin-left:22px}
        .ai-summary-content ul > li.ai-sub::before{width:5px;height:5px;background:#a78bfa;top:11px}
        .ai-summary-content strong{color:#7c3aed}
        .ai-summary-content code{background:rgba(124,58,237,.06);padding:2px 6px;border-radius:4px;font-size:.85rem}
        .ai-summary-content hr{border:none;height:2px;background:linear-gradient(90deg,rgba(124,58,237,.15),transparent);margin:20px 0}

        /* Callout boxes */
        .ai-callout{border-radius:10px;padding:14px 18px;margin:16px 0;border-left:4px solid}
        .ai-callout-header{display:flex;align-items:center;gap:8px;font-weight:700;font-size:.88rem;margin-bottom:6px}
        .ai-callout--key{background:linear-gradient(135deg,#f5f3ff,#ede9fe);border-color:#7c3aed}
        .ai-callout--key .ai-callout-header{color:#7c3aed}
        .ai-callout--warning{background:#fef2f2;border-color:#ef4444}
        .ai-callout--warning .ai-callout-header{color:#dc2626}
        .ai-callout--tip{background:#ecfdf5;border-color:#10b981}
        .ai-callout--tip .ai-callout-header{color:#059669}
        .ai-callout--nclex{background:linear-gradient(135deg,#fffbeb,#fef3c7);border-color:#f59e0b}
        .ai-callout--nclex .ai-callout-header{color:#d97706}

        /* Quick Review section */
        .ai-quick-review{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:1px solid rgba(16,185,129,.2);border-radius:12px;padding:20px 24px;margin-top:24px}
        .ai-quick-review h2,.ai-quick-review h3{color:#059669!important;border-bottom:none!important;margin-top:0!important}

        /* Table of Contents (auto-generated navigation) */
        .ai-toc{background:linear-gradient(135deg,#faf5ff,#f3e8ff);border:1px solid rgba(124,58,237,.15);border-radius:12px;padding:16px 20px;margin-bottom:24px}
        .ai-toc-header{display:flex;align-items:center;gap:8px;font-family:'Outfit',sans-serif;font-size:.88rem;font-weight:700;color:#7c3aed;margin-bottom:10px}
        .ai-toc-header i{font-size:.82rem}
        .ai-toc-links{display:flex;flex-wrap:wrap;gap:6px 8px}
        .ai-toc-link{display:inline-flex;align-items:center;padding:5px 14px;background:rgba(124,58,237,.08);color:#6d28d9;font-size:.8rem;font-weight:500;border-radius:20px;text-decoration:none;transition:all .15s;border:1px solid transparent;cursor:pointer}
        .ai-toc-link:hover{background:rgba(124,58,237,.16);border-color:rgba(124,58,237,.25);transform:translateY(-1px);color:#6d28d9;text-decoration:none}
        .ai-toc-link:active{transform:translateY(0)}

        /* Markdown tables */
        .ai-table-wrapper{overflow-x:auto;margin:16px 0;border-radius:8px;border:1px solid rgba(0,0,0,.08)}
        .ai-md-table{width:100%;border-collapse:collapse;font-size:.85rem}
        .ai-md-table th{background:rgba(124,58,237,.06);padding:8px 12px;text-align:left;font-weight:600;color:#1e293b;border-bottom:2px solid rgba(124,58,237,.15)}
        .ai-md-table td{padding:8px 12px;border-bottom:1px solid rgba(0,0,0,.05);color:#334155}
        .ai-md-table tr:last-child td{border-bottom:none}
        .ai-md-table tr:hover td{background:rgba(124,58,237,.03)}
        .ai-md-table tbody tr:nth-child(even) td{background:rgba(124,58,237,.02)}

        /* Answer reveals (practice questions) */
        .ai-answer-reveal{margin:8px 0 12px;border-radius:8px;overflow:hidden}
        .ai-answer-reveal:not([open]) .ai-answer-content{display:none}
        .ai-answer-toggle{display:flex;align-items:center;gap:6px;padding:10px 14px;background:rgba(59,130,246,.08);color:#3b82f6;font-weight:600;font-size:.85rem;cursor:pointer;border-radius:8px;list-style:none;transition:background .15s}
        .ai-answer-toggle:hover{background:rgba(59,130,246,.14)}
        .ai-answer-toggle::-webkit-details-marker{display:none}
        .ai-answer-toggle::marker{display:none;content:''}
        .ai-answer-reveal[open] .ai-answer-toggle{border-radius:8px 8px 0 0}
        .ai-answer-content{padding:12px 14px;background:rgba(59,130,246,.04);border:1px solid rgba(59,130,246,.1);border-top:none;border-radius:0 0 8px 8px;font-size:.88rem;line-height:1.6}
        .ai-rationale-reveal .ai-answer-toggle{background:rgba(16,185,129,.08);color:#059669}
        .ai-rationale-reveal .ai-answer-toggle:hover{background:rgba(16,185,129,.14)}
        .ai-rationale-reveal .ai-answer-content{background:rgba(16,185,129,.04);border-color:rgba(16,185,129,.1)}

        /* Concept tag */
        .ai-concept-tag{display:inline-flex;align-items:center;gap:5px;padding:4px 12px;background:rgba(124,58,237,.06);color:#7c3aed;font-size:.78rem;font-weight:600;border-radius:20px;margin:6px 0 16px}

        /* Answer option letters */
        .ai-option{display:flex;align-items:baseline;gap:8px;padding:4px 0;font-size:.9rem}
        .ai-option-letter{display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:50%;background:rgba(59,130,246,.08);color:#3b82f6;font-weight:700;font-size:.78rem;flex-shrink:0}

        /* Generating state (shown while waiting for LLM response) */
        .ai-generating-state{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:60px 24px;min-height:300px;color:#64748b}
        .ai-generating-state h3{margin:20px 0 8px;color:#334155;font-size:1.1rem;font-weight:600}
        .ai-generating-state p{margin:0 0 4px;font-size:.9rem;line-height:1.5}
        .ai-generating-hint{font-size:.8rem !important;color:#94a3b8;margin-top:12px !important}
        .ai-generating-spinner{width:40px;height:40px;border:3px solid rgba(124,58,237,.15);border-top-color:#7c3aed;border-radius:50%;animation:aiSpin 0.8s linear infinite}
        @keyframes aiSpin{to{transform:rotate(360deg)}}

        /* Disclaimer footer */
        .ai-summary-disclaimer{flex-shrink:0;padding:10px 20px;border-top:1px solid rgba(0,0,0,.06);text-align:center;font-size:.73rem;color:#94a3b8;display:flex;align-items:center;justify-content:center;gap:6px;background:#fafbfc}
        .ai-summary-disclaimer i{color:#f59e0b;font-size:.8rem}

        /* Upgrade prompt */
        .ai-upgrade-prompt{margin-top:28px}
        .ai-upgrade-card{text-align:center;padding:40px 24px;background:linear-gradient(135deg,#f5f3ff 0%,#ede9fe 100%);border:1px solid #c4b5fd;border-radius:16px}
        .ai-upgrade-icon{font-size:2.5rem;color:#7c3aed;margin-bottom:12px}
        .ai-upgrade-card h3{font-family:'Outfit',sans-serif;font-size:1.15rem;font-weight:700;color:#1e293b;margin:0 0 8px}
        .ai-upgrade-card p{font-size:.9rem;color:#64748b;max-width:420px;margin:0 auto 16px;line-height:1.5}
        .ai-upgrade-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 24px;background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;border-radius:10px;font-size:.9rem;font-weight:700;text-decoration:none;transition:all .2s}
        .ai-upgrade-btn:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(124,58,237,.3);color:#fff;text-decoration:none}

        /* Dark mode overrides */
        [data-theme="dark"] .ai-tools-section .section-title{color:#f1f5f9}
        [data-theme="dark"] .ai-tools-section .section-title i{color:#a78bfa}
        [data-theme="dark"] .ai-upload-dropzone{border-color:rgba(255,255,255,.1);background:rgba(255,255,255,.02)}
        [data-theme="dark"] .ai-upload-dropzone:hover,[data-theme="dark"] .ai-upload-dropzone.drag-over{border-color:#a78bfa;background:rgba(124,58,237,.08)}
        [data-theme="dark"] .ai-upload-icon{color:#6b7280}
        [data-theme="dark"] .ai-upload-dropzone:hover .ai-upload-icon{color:#a78bfa}
        [data-theme="dark"] .ai-upload-text{color:#cbd5e1}
        [data-theme="dark"] .ai-upload-text strong{color:#f1f5f9}
        [data-theme="dark"] .ai-upload-formats,[data-theme="dark"] .ai-upload-text span{color:#6b7280}
        [data-theme="dark"] .ai-upload-progress{background:rgba(255,255,255,.04);border-color:rgba(255,255,255,.06)}
        [data-theme="dark"] .ai-progress-info{color:#cbd5e1}
        [data-theme="dark"] .ai-progress-bar{background:rgba(255,255,255,.08)}
        [data-theme="dark"] .ai-documents-header h3{color:#e2e8f0}
        [data-theme="dark"] .ai-doc-card{background:rgba(255,255,255,.04);border-color:rgba(255,255,255,.06)}
        [data-theme="dark"] .ai-doc-card:hover{border-color:rgba(167,139,250,.3)}
        [data-theme="dark"] .ai-doc-name{color:#f1f5f9}
        [data-theme="dark"] .ai-doc-meta{color:#6b7280}
        [data-theme="dark"] .ai-empty-state{color:#6b7280}
        [data-theme="dark"] .ai-action-btn{border-color:rgba(255,255,255,.06)}
        [data-theme="dark"] .ai-action-btn:hover:not(:disabled){border-color:var(--action-color);box-shadow:0 3px 10px rgba(0,0,0,.2)}
        [data-theme="dark"] .ai-action-cached{box-shadow:0 0 0 2px rgba(30,30,46,1)}
        [data-theme="dark"] .ai-summary-panel{background:#1e1e2e;box-shadow:-4px 0 24px rgba(0,0,0,.4)}
        [data-theme="dark"] .ai-summary-content{color:#cbd5e1}
        [data-theme="dark"] .ai-summary-content h1,[data-theme="dark"] .ai-summary-content h2,[data-theme="dark"] .ai-summary-content h3{color:#f1f5f9}
        [data-theme="dark"] .ai-summary-content h2{border-color:rgba(167,139,250,.3);background:linear-gradient(135deg,rgba(124,58,237,.15),rgba(124,58,237,.08))}
        [data-theme="dark"] .ai-summary-content h2 i{color:#a78bfa}
        [data-theme="dark"] .ai-summary-content h3{border-color:rgba(167,139,250,.25)}
        [data-theme="dark"] .ai-summary-content ul > li::before{background:#a78bfa}
        [data-theme="dark"] .ai-summary-content ul > li.ai-sub::before{background:#8b5cf6}
        [data-theme="dark"] .ai-toc{background:rgba(124,58,237,.08);border-color:rgba(124,58,237,.2)}
        [data-theme="dark"] .ai-toc-header{color:#a78bfa}
        [data-theme="dark"] .ai-toc-link{background:rgba(167,139,250,.1);color:#c4b5fd}
        [data-theme="dark"] .ai-toc-link:hover{background:rgba(167,139,250,.2);border-color:rgba(167,139,250,.3);color:#c4b5fd}
        [data-theme="dark"] .ai-summary-content strong{color:#a78bfa}
        [data-theme="dark"] .ai-summary-content code{background:rgba(167,139,250,.1)}
        [data-theme="dark"] .ai-callout--key{background:rgba(124,58,237,.1)}
        [data-theme="dark"] .ai-callout--warning{background:rgba(239,68,68,.08)}
        [data-theme="dark"] .ai-callout--tip{background:rgba(16,185,129,.08)}
        [data-theme="dark"] .ai-callout--nclex{background:rgba(245,158,11,.08)}
        [data-theme="dark"] .ai-quick-review{background:rgba(16,185,129,.08);border-color:rgba(16,185,129,.15)}
        [data-theme="dark"] .ai-table-wrapper{border-color:rgba(255,255,255,.08)}
        [data-theme="dark"] .ai-md-table th{background:rgba(167,139,250,.1);color:#f1f5f9;border-color:rgba(167,139,250,.2)}
        [data-theme="dark"] .ai-md-table td{color:#cbd5e1;border-color:rgba(255,255,255,.05)}
        [data-theme="dark"] .ai-md-table tr:hover td{background:rgba(167,139,250,.05)}
        [data-theme="dark"] .ai-answer-toggle{background:rgba(59,130,246,.12)}
        [data-theme="dark"] .ai-answer-content{background:rgba(59,130,246,.06);border-color:rgba(59,130,246,.15)}
        [data-theme="dark"] .ai-rationale-reveal .ai-answer-toggle{background:rgba(16,185,129,.1)}
        [data-theme="dark"] .ai-rationale-reveal .ai-answer-content{background:rgba(16,185,129,.06);border-color:rgba(16,185,129,.12)}
        [data-theme="dark"] .ai-concept-tag{background:rgba(167,139,250,.1);color:#a78bfa}
        [data-theme="dark"] .ai-option-letter{background:rgba(59,130,246,.12)}
        [data-theme="dark"] .ai-summary-disclaimer{background:rgba(255,255,255,.02);border-color:rgba(255,255,255,.06)}
        [data-theme="dark"] .ai-generating-state{color:#94a3b8}
        [data-theme="dark"] .ai-generating-state h3{color:#e2e8f0}
        [data-theme="dark"] .ai-generating-spinner{border-color:rgba(167,139,250,.2);border-top-color:#a78bfa}
        [data-theme="dark"] .ai-upgrade-card{background:rgba(124,58,237,.08);border-color:rgba(124,58,237,.2)}
        [data-theme="dark"] .ai-upgrade-card h3{color:#f1f5f9}
        [data-theme="dark"] .ai-upgrade-card p{color:#94a3b8}

        @media(max-width:768px){
            .ai-upload-dropzone{padding:24px 16px}
            .ai-action-grid{gap:3px;padding:3px 10px 10px}
            .ai-action-btn{padding:8px 3px 6px;font-size:.63rem}
            .ai-action-btn i{font-size:.8rem}
            .ai-summary-panel{width:100vw}
            .ai-summary-toolbar{flex-wrap:wrap;gap:8px;padding:10px 14px}
            .ai-toolbar-label{display:none}
            .ai-summary-doc-name{max-width:160px;font-size:.85rem}
            .ai-summary-body{padding:20px 16px}
            .ai-md-table{font-size:.78rem}
            .ai-md-table th,.ai-md-table td{padding:6px 8px}
        }
        .ai-print-header{display:none}
        @media print{
            @page{margin:1.5cm}
            /* Hide ALL page elements except the panel content */
            body{overflow:visible!important}
            .navbar,.footer,.page-loader,.skip-link,.ai-summary-backdrop,.ai-summary-disclaimer{display:none!important}
            .ai-upload-dropzone,.ai-upload-progress,.ai-documents,.ai-documents-header,.ai-empty-state,.ai-upgrade-prompt,.section-header-row{display:none!important}
            .ai-summary-toolbar{display:none!important}
            /* Show print header with doc name */
            .ai-print-header{display:block!important;text-align:center;padding:0 0 16px;margin-bottom:24px;border-bottom:2px solid #7c3aed}
            .ai-print-header h1{font-family:'Outfit',sans-serif;font-size:16pt;font-weight:700;color:#1e293b;margin:0 0 4px}
            .ai-print-header p{font-size:9pt;color:#64748b;margin:0}
            /* Make panel fill page */
            .ai-tools-page,.ai-tools-section{display:block!important;padding:0!important;margin:0!important}
            .ai-summary-panel{position:static!important;width:100%!important;height:auto!important;transform:none!important;box-shadow:none!important;display:block!important;z-index:auto!important}
            .ai-summary-body{overflow:visible!important;padding:0!important}
            /* Content print styles */
            .ai-summary-content{font-size:10.5pt;line-height:1.55;color:#000;max-width:100%}
            .ai-summary-content h1{font-size:14pt;color:#000;border-color:#333;margin-top:12px}
            .ai-summary-content h2{font-size:11pt;color:#000;background:#f5f3ff!important;border-color:#7c3aed;-webkit-print-color-adjust:exact;print-color-adjust:exact;break-after:avoid;padding:8px 12px}
            .ai-summary-content h2 i{color:#7c3aed;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-summary-content h3{font-size:10.5pt;color:#222;border-color:#999}
            .ai-summary-content strong{color:#333}
            .ai-summary-content ul > li::before{background:#333;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            /* Keep elements together */
            .ai-callout{break-inside:avoid;border-left-width:3px!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-quick-review{break-inside:avoid;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-table-wrapper{break-inside:avoid}
            .ai-toc{break-inside:avoid;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-toc-link{border:1px solid #ccc!important;color:#333!important;background:#f5f3ff!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-answer-reveal{break-inside:avoid}
            .ai-answer-reveal[open] .ai-answer-content{display:block}
            h2,h3{break-after:avoid}
            /* Tables */
            .ai-md-table th{background:#f0f0f0!important;color:#000;border-color:#ccc;-webkit-print-color-adjust:exact;print-color-adjust:exact}
            .ai-md-table td{color:#000;border-color:#ddd}
        }
    </style>
</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader" id="page-loader">
        <div class="loader-spinner"></div>
    </div>

    <!-- Skip to main content -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="index.html">
                    <img src="assets/images/the-nursing-collective-logo.webp" alt="The Nursing Collective Logo" class="nav-logo">
                </a>
            </div>
            <div class="nav-links">
                <a href="dashboard.html">Dashboard</a>
                <a href="resources.html">Resources</a>
                <a href="pricing.html">Pricing</a>
                <a href="about.html">About</a>
                <div class="user-menu">
                    <button class="user-avatar" id="user-menu-btn" title="Account menu">
                        <i class="fas fa-user-circle"></i>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <div class="user-dropdown-header">
                            <div class="user-avatar-large">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="user-info">
                                <span class="user-name" id="dropdown-user-name">Loading...</span>
                                <span class="user-email" id="dropdown-user-email">Loading...</span>
                            </div>
                        </div>
                        <div class="user-dropdown-divider"></div>
                        <div class="theme-selector">
                            <span class="theme-selector-label"><i class="fas fa-palette"></i> Theme</span>
                            <div class="theme-selector-options">
                                <button class="theme-option" data-theme-mode="light" title="Light mode">
                                    <i class="fas fa-sun"></i>
                                </button>
                                <button class="theme-option" data-theme-mode="dark" title="Dark mode">
                                    <i class="fas fa-moon"></i>
                                </button>
                                <button class="theme-option" data-theme-mode="system" title="System preference">
                                    <i class="fas fa-desktop"></i>
                                </button>
                            </div>
                        </div>
                        <div class="user-dropdown-divider"></div>
                        <a href="dashboard.html#subscription"><i class="fas fa-crown"></i> My Subscription</a>
                        <a href="settings.html"><i class="fas fa-cog"></i> Account Settings</a>
                        <div class="user-dropdown-divider"></div>
                        <a href="contact.html"><i class="fas fa-question-circle"></i> Help & Support</a>
                        <a href="#logout" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
            <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle navigation menu" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <section class="ai-tools-page" id="ai-tools-page">

            <!-- AI Tools (shown for AI-plan users) -->
            <div class="ai-tools-section" id="ai-tools-section">

                <!-- Upload Area -->
                <div class="ai-upload-dropzone" id="ai-upload-dropzone">
                    <input type="file" id="ai-file-input" accept=".pdf,.docx,.pptx" hidden>
                    <div class="ai-upload-icon"><i class="fas fa-cloud-arrow-up"></i></div>
                    <div class="ai-upload-text">
                        <strong>Drag &amp; drop your lecture notes</strong>
                        <span>or click to browse</span>
                    </div>
                    <div class="ai-upload-formats">PDF, DOCX, PPTX &bull; Max 25 MB</div>
                </div>

                <!-- Upload Progress (hidden by default) -->
                <div class="ai-upload-progress hidden" id="ai-upload-progress">
                    <div class="ai-progress-info">
                        <span class="ai-progress-filename" id="ai-progress-filename">filename.pdf</span>
                        <span class="ai-progress-pct" id="ai-progress-pct">0%</span>
                    </div>
                    <div class="ai-progress-bar">
                        <div class="ai-progress-fill" id="ai-progress-fill" style="width:0%"></div>
                    </div>
                </div>

                <!-- Document List -->
                <div class="ai-documents" id="ai-documents">
                    <div class="ai-documents-header">
                        <h3>Your Documents</h3>
                        <button class="ai-refresh-btn" id="ai-refresh-btn" title="Refresh">
                            <i class="fas fa-arrows-rotate"></i>
                        </button>
                    </div>
                    <div class="ai-documents-list" id="ai-documents-list">
                        <!-- Populated by ai-tools-script.js -->
                        <div class="ai-empty-state" id="ai-empty-state">
                            <i class="fas fa-file-circle-plus"></i>
                            <p>No documents yet. Upload your first set of notes above!</p>
                        </div>
                    </div>
                </div>

                <!-- Summary Viewer (slide-over panel) -->
                <div class="ai-summary-backdrop hidden" id="ai-summary-backdrop"></div>
                <div class="ai-summary-panel hidden" id="ai-summary-panel" role="dialog" aria-label="AI Study Tool">
                    <div class="ai-summary-toolbar">
                        <div class="ai-summary-toolbar-left">
                            <button class="ai-toolbar-btn" id="ai-summary-back" title="Close">
                                <i class="fas fa-arrow-left"></i>
                                <span class="ai-toolbar-label">Back</span>
                            </button>
                            <div class="ai-summary-doc-name" id="ai-summary-doc-name">Review Sheet</div>
                        </div>
                        <div class="ai-summary-toolbar-right">
                            <button class="ai-toolbar-btn" id="ai-summary-copy" title="Copy to clipboard">
                                <i class="fas fa-copy"></i>
                                <span class="ai-toolbar-label">Copy</span>
                            </button>
                            <button class="ai-toolbar-btn" id="ai-summary-print" title="Print / Save as PDF">
                                <i class="fas fa-file-pdf"></i>
                                <span class="ai-toolbar-label">PDF</span>
                            </button>
                            <button class="ai-toolbar-btn ai-toolbar-btn--regenerate" id="ai-summary-regenerate" title="Regenerate summary">
                                <i class="fas fa-arrows-rotate"></i>
                                <span class="ai-toolbar-label">Regenerate</span>
                            </button>
                            <button class="ai-toolbar-btn ai-toolbar-btn--quiz hidden" id="ai-summary-quiz" title="Take as interactive quiz">
                                <i class="fas fa-play-circle"></i>
                                <span class="ai-toolbar-label">Quiz</span>
                            </button>
                        </div>
                    </div>
                    <div class="ai-summary-body" id="ai-summary-body">
                        <div class="ai-print-header" id="ai-print-header">
                            <h1 id="ai-print-title"></h1>
                            <p>Generated by The Nursing Collective AI Study Tools</p>
                        </div>
                        <div class="ai-summary-content" id="ai-summary-content"></div>
                    </div>
                    <div class="ai-summary-disclaimer">
                        <i class="fas fa-triangle-exclamation"></i>
                        AI-generated content &mdash; always verify with your textbook and instructor
                    </div>
                </div>
            </div>

            <!-- Upgrade prompt for non-AI users (shown instead of AI tools) -->
            <div class="ai-upgrade-prompt hidden" id="ai-upgrade-prompt">
                <div class="section-header-row">
                    <h2 class="section-title"><i class="fas fa-wand-magic-sparkles"></i> AI Study Tools</h2>
                </div>
                <div class="ai-upgrade-card">
                    <div class="ai-upgrade-icon"><i class="fas fa-sparkles"></i></div>
                    <h3>Supercharge Your Studying</h3>
                    <p>Upload your lecture notes and get AI-generated review sheets, NCLEX practice questions, and gap analysis.</p>
                    <a href="pricing.html?tier=ai" class="ai-upgrade-btn" data-navigate="pricing.html?tier=ai">
                        <i class="fas fa-bolt"></i> Upgrade to AI-Powered
                    </a>
                </div>
            </div>

        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-brand">
                        <span>The Nursing Collective</span>
                    </div>
                    <p>Empowering nursing students with comprehensive study guides, practice questions, and resources for academic success.</p>
                </div>

                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="resources.html">Resources</a></li>
                        <li><a href="pricing.html">Pricing</a></li>
                        <li><a href="https://discord.gg/y2Mh77wAV2">Discord</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>
                        <i class="fas fa-envelope"></i>
                        <a href="mailto:support@thenursingcollective.pro">support@thenursingcollective.pro</a>
                    </p>
                    <div class="social-links">
                        <a href="https://discord.gg/y2Mh77wAV2" aria-label="Discord" target="_blank" rel="noopener">
                            <i class="fab fa-discord"></i>
                        </a>
                    </div>
                </div>

                <div class="footer-section">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2026 The Nursing Collective. Built with care for nursing students.</p>
                <p class="footer-attribution">
                    Icons by <a href="https://www.flaticon.com/authors/freepik" title="Freepik" target="_blank" rel="noopener">Freepik</a> & <a href="https://www.flaticon.com/authors/slamlabs" title="Slamlabs" target="_blank" rel="noopener">Slamlabs</a> - <a href="https://www.flaticon.com" title="Flaticon" target="_blank" rel="noopener">Flaticon</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Dark Mode Manager (runs first to prevent flash) -->
    <script src="dark-mode.js"></script>
    <!-- API Service Layer (loads early to pre-warm stale tokens) -->
    <script src="api-service.js?v=1769142742"></script>
    <!-- Remaining scripts: defer lets browser pre-fetch in parallel -->
    <script defer src="script.js?v=4.8.dashboard"></script>
    <script defer src="sidebar.js?v=1.3.ai-tools"></script>
    <script defer src="ai-tools-script.js?v=1.4.0"></script>
</body>
</html>
